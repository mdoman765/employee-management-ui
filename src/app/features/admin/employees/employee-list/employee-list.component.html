<div class="page">
  <!-- Header -->
  <div class="page-header">
    <div>
      <h3>ğŸ‘¥ Employees</h3>
      <p class="text-muted">Manage all employee records</p>
    </div>
    <a routerLink="/admin/employees/new" class="btn btn-primary">+ Add Employee</a>
  </div>

  <!-- Alerts -->
  <div class="alert alert-success alert-dismissible" *ngIf="successMsg">
    âœ… {{ successMsg }}
  </div>
  <div class="alert alert-danger" *ngIf="errorMsg">âš ï¸ {{ errorMsg }}</div>

  <!-- Search Bar -->
  <div class="search-bar">
    <span class="search-icon">ğŸ”</span>
    <input type="text" [(ngModel)]="search" (ngModelChange)="applyFilter()"
      placeholder="Search by name, email or department..." class="form-control" />
    <button *ngIf="search" (click)="search=''; applyFilter()" class="clear-btn">âœ•</button>
  </div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-box">
    <div class="spinner-border text-primary"></div>
    <span>Loading employees...</span>
  </div>

  <!-- Table -->
  <div class="table-card" *ngIf="!loading">
    <div class="table-info">
      Showing <strong>{{ filtered.length }}</strong> of <strong>{{ employees.length }}</strong> employees
    </div>
    <div class="table-responsive">
      <table class="data-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Name</th>
            <th>Email</th>
            <th>Phone</th>
            <th>Department</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let emp of filtered; let i = index">
            <td class="text-muted">{{ i + 1 }}</td>
            <td>
              <div class="emp-name">
                <div class="emp-avatar">{{ emp.name.charAt(0) }}</div>
                <span>{{ emp.name }}</span>
              </div>
            </td>
            <td>{{ emp.email }}</td>
            <td>{{ emp.phone || 'â€”' }}</td>
            <td><span class="badge-dept">{{ emp.departmentName }}</span></td>
            <td>
              <span class="badge-status" [class.active]="emp.isActive" [class.inactive]="!emp.isActive">
                {{ emp.isActive ? 'Active' : 'Inactive' }}
              </span>
            </td>
            <td>
              <div class="action-btns">
                <a [routerLink]="['/admin/employees/edit', emp.id]" class="btn-action edit" title="Edit">âœï¸</a>
                <button (click)="confirmDelete(emp.id)" class="btn-action delete" title="Delete">ğŸ—‘ï¸</button>
              </div>
            </td>
          </tr>
          <tr *ngIf="filtered.length === 0">
            <td colspan="7" class="empty-row">
              <div>ğŸ” No employees found.</div>
              <small *ngIf="search">Try a different search term.</small>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div class="modal-overlay" *ngIf="deleteId">
    <div class="modal-box">
      <div class="modal-icon">ğŸ—‘ï¸</div>
      <h5>Delete Employee?</h5>
      <p>This action will deactivate the employee record. This cannot be undone.</p>
      <div class="modal-actions">
        <button (click)="cancelDelete()" class="btn btn-secondary">Cancel</button>
        <button (click)="doDelete()" class="btn btn-danger" [disabled]="deleting">
          <span *ngIf="deleting" class="spinner-border spinner-border-sm me-1"></span>
          {{ deleting ? 'Deleting...' : 'Yes, Delete' }}
        </button>
      </div>
    </div>
  </div>
</div>
