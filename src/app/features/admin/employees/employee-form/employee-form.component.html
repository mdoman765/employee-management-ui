<div class="page">
  <div class="page-header">
    <div>
      <h3>{{ isEdit ? '✏️ Edit Employee' : '➕ Add New Employee' }}</h3>
      <p class="text-muted">{{ isEdit ? 'Update employee information' : 'Fill in the details to add a new employee' }}</p>
    </div>
    <a routerLink="/admin/employees" class="btn btn-outline-secondary">← Back to List</a>
  </div>

  <div class="alert alert-danger" *ngIf="errorMsg">⚠️ {{ errorMsg }}</div>

  <div class="form-card">
    <form [formGroup]="form" (ngSubmit)="submit()">
      <div class="form-section">
        <h6 class="section-title">Personal Information</h6>
        <div class="form-grid">
          <div class="form-group">
            <label>Full Name <span class="required">*</span></label>
            <input formControlName="name" type="text" class="form-control"
              [class.is-invalid]="f['name'].invalid && f['name'].touched"
              placeholder="Enter full name" />
            <div class="invalid-feedback" *ngIf="f['name'].errors?.['required'] && f['name'].touched">
              Full name is required.
            </div>
            <div class="invalid-feedback" *ngIf="f['name'].errors?.['minlength'] && f['name'].touched">
              Minimum 2 characters required.
            </div>
          </div>

          <div class="form-group">
            <label>Email Address <span class="required">*</span></label>
            <input formControlName="email" type="email" class="form-control"
              [class.is-invalid]="f['email'].invalid && f['email'].touched"
              placeholder="Enter email address" />
            <div class="invalid-feedback" *ngIf="f['email'].errors?.['required'] && f['email'].touched">
              Email is required.
            </div>
            <div class="invalid-feedback" *ngIf="f['email'].errors?.['email'] && f['email'].touched">
              Enter a valid email address.
            </div>
          </div>

          <div class="form-group">
            <label>Phone Number</label>
            <input formControlName="phone" type="text" class="form-control"
              placeholder="e.g. +968 9999 9999" />
          </div>

          <div class="form-group">
            <label>Account Number</label>
            <input formControlName="accountNumber" type="text" class="form-control"
              placeholder="Bank account number" />
          </div>
        </div>
      </div>

      <div class="form-section">
        <h6 class="section-title">Job Information</h6>
        <div class="form-grid">
          <div class="form-group">
            <label>Department <span class="required">*</span></label>
            <select formControlName="departmentId" class="form-select"
              [class.is-invalid]="f['departmentId'].invalid && f['departmentId'].touched">
              <option value="">-- Select Department --</option>
              <option *ngFor="let d of departments" [value]="d.id">{{ d.name }}</option>
            </select>
            <div class="invalid-feedback" *ngIf="f['departmentId'].invalid && f['departmentId'].touched">
              Please select a department.
            </div>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <a routerLink="/admin/employees" class="btn btn-outline-secondary">Cancel</a>
        <button type="submit" class="btn btn-primary" [disabled]="saving">
          <span *ngIf="saving" class="spinner-border spinner-border-sm me-2"></span>
          {{ saving ? 'Saving...' : (isEdit ? 'Update Employee' : 'Create Employee') }}
        </button>
      </div>
    </form>
  </div>
</div>
